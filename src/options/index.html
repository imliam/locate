<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Locate - Options</title>
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="header-content">
        <img src="../../assets/icons/icon48.png" alt="Locate" class="header-icon">
        <div>
          <h1>Locate Options</h1>
          <p>Configure your advanced search experience</p>
        </div>
      </div>
    </header>

    <!-- General Settings -->
    <section class="card">
      <h2>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
        </svg>
        General
      </h2>

      <div class="setting-row">
        <div class="setting-info">
          <label for="autoSearch">Search as you type</label>
          <p class="setting-description">Automatically search while typing (disable for better performance on large pages)</p>
        </div>
        <label class="toggle">
          <input type="checkbox" id="autoSearch">
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div class="setting-row">
        <div class="setting-info">
          <label for="searchDelay">Search delay</label>
          <p class="setting-description">Milliseconds to wait before searching (when "Search as you type" is enabled)</p>
        </div>
        <input type="number" id="searchDelay" class="input-number" min="0" max="1000" step="50">
      </div>
    </section>

    <!-- Appearance Settings -->
    <section class="card">
      <h2>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/>
        </svg>
        Appearance
      </h2>

      <div class="setting-row">
        <div class="setting-info">
          <label for="theme">Theme</label>
          <p class="setting-description">Color scheme for the search overlay</p>
        </div>
        <select id="theme" class="select">
          <option value="system">System</option>
          <option value="light">Light</option>
          <option value="dark">Dark</option>
        </select>
      </div>

      <div class="setting-row">
        <div class="setting-info">
          <label for="highlightColor">Highlight color</label>
          <p class="setting-description">Color for search result highlights</p>
        </div>
        <div class="color-input-wrapper">
          <input type="color" id="highlightColor" class="input-color">
          <input type="text" id="highlightColorText" class="input-color-text" placeholder="#ffeb3b">
        </div>
      </div>

      <div class="setting-row">
        <div class="setting-info">
          <label for="highlightCurrentColor">Current match color</label>
          <p class="setting-description">Color for the currently selected match</p>
        </div>
        <div class="color-input-wrapper">
          <input type="color" id="highlightCurrentColor" class="input-color">
          <input type="text" id="highlightCurrentColorText" class="input-color-text" placeholder="#ff9800">
        </div>
      </div>

      <div class="setting-row">
        <div class="setting-info">
          <label for="highlightOpacity">Highlight opacity</label>
          <p class="setting-description">Transparency of highlights (0 = transparent, 1 = solid)</p>
        </div>
        <div class="range-wrapper">
          <input type="range" id="highlightOpacity" class="input-range" min="0.1" max="1" step="0.1">
          <span id="highlightOpacityValue" class="range-value">0.4</span>
        </div>
      </div>
    </section>

    <!-- Keyboard Shortcuts -->
    <section class="card">
      <h2>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"/>
        </svg>
        Keyboard Shortcuts
      </h2>

      <p class="section-description">Click on a shortcut to change it. Press Escape to cancel.</p>

      <div id="keybinds-container" class="keybinds-container">
        <!-- Keybinds will be populated dynamically -->
      </div>

      <div class="button-group">
        <button id="resetKeybinds" class="btn btn-secondary">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
          </svg>
          Reset All Shortcuts
        </button>
      </div>
    </section>

    <!-- Default Search Options -->
    <section class="card">
      <h2>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
        </svg>
        Default Search Options
      </h2>

      <div class="setting-row">
        <div class="setting-info">
          <label for="caseSensitive">Case sensitive</label>
          <p class="setting-description">Match uppercase and lowercase exactly by default</p>
        </div>
        <label class="toggle">
          <input type="checkbox" id="caseSensitive">
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div class="setting-row">
        <div class="setting-info">
          <label for="wholeWord">Whole word</label>
          <p class="setting-description">Match whole words only by default</p>
        </div>
        <label class="toggle">
          <input type="checkbox" id="wholeWord">
          <span class="toggle-slider"></span>
        </label>
      </div>
    </section>

    <!-- Import/Export -->
    <section class="card">
      <h2>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/>
        </svg>
        Import / Export
      </h2>

      <p class="section-description">Backup your settings or transfer them to another device.</p>

      <div class="button-group">
        <button id="exportSettings" class="btn btn-primary">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
          </svg>
          Export Settings
        </button>
        <button id="importSettings" class="btn btn-secondary">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M9 16h6v-6h4l-7-7-7 7h4v6zm-4 2h14v2H5v-2z"/>
          </svg>
          Import Settings
        </button>
        <input type="file" id="importFile" accept=".json" hidden>
      </div>
    </section>

    <!-- AI Settings -->
    <section class="card">
      <h2>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
        </svg>
        AI Assistant
      </h2>

      <p class="section-description">Configure AI providers for smart search assistance. API keys are stored locally and never sent to our servers.</p>

      <div class="setting-row">
        <div class="setting-info">
          <label for="aiProvider">AI Provider</label>
          <p class="setting-description">Select which AI service to use</p>
        </div>
        <select id="aiProvider" class="select">
          <option value="openai">OpenAI</option>
          <option value="anthropic">Anthropic</option>
          <option value="google">Google</option>
        </select>
      </div>

      <div class="setting-row">
        <div class="setting-info">
          <label for="aiModel">Model</label>
          <p class="setting-description">Select which model to use</p>
        </div>
        <select id="aiModel" class="select">
          <!-- Populated dynamically -->
        </select>
      </div>

      <div class="api-key-section">
        <h3 class="subsection-title">API Keys</h3>
        <p class="section-description">Enter your API keys below. Get keys from:
          <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI</a>,
          <a href="https://console.anthropic.com/settings/keys" target="_blank">Anthropic</a>,
          <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI</a>
        </p>

        <div class="setting-row">
          <div class="setting-info">
            <label for="openaiKey">OpenAI API Key</label>
            <p class="setting-description">Starts with sk-...</p>
          </div>
          <div class="api-key-input-wrapper">
            <input type="password" id="openaiKey" class="input-text api-key-input" placeholder="sk-...">
            <button type="button" class="btn-icon toggle-visibility" data-target="openaiKey" title="Show/hide">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
              </svg>
            </button>
            <button type="button" class="btn btn-small test-connection" data-provider="openai">Test</button>
          </div>
        </div>

        <div class="setting-row">
          <div class="setting-info">
            <label for="anthropicKey">Anthropic API Key</label>
            <p class="setting-description">Starts with sk-ant-...</p>
          </div>
          <div class="api-key-input-wrapper">
            <input type="password" id="anthropicKey" class="input-text api-key-input" placeholder="sk-ant-...">
            <button type="button" class="btn-icon toggle-visibility" data-target="anthropicKey" title="Show/hide">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
              </svg>
            </button>
            <button type="button" class="btn btn-small test-connection" data-provider="anthropic">Test</button>
          </div>
        </div>

        <div class="setting-row">
          <div class="setting-info">
            <label for="googleKey">Google AI API Key</label>
            <p class="setting-description">Get from Google AI Studio</p>
          </div>
          <div class="api-key-input-wrapper">
            <input type="password" id="googleKey" class="input-text api-key-input" placeholder="AIza...">
            <button type="button" class="btn-icon toggle-visibility" data-target="googleKey" title="Show/hide">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
              </svg>
            </button>
            <button type="button" class="btn btn-small test-connection" data-provider="google">Test</button>
          </div>
        </div>
      </div>

      <div class="setting-row">
        <div class="setting-info">
          <label for="aiTemperature">Temperature</label>
          <p class="setting-description">Controls randomness (0 = focused, 1 = creative)</p>
        </div>
        <div class="range-wrapper">
          <input type="range" id="aiTemperature" class="input-range" min="0" max="1" step="0.1" value="0.7">
          <span id="aiTemperatureValue" class="range-value">0.7</span>
        </div>
      </div>

      <div class="setting-row">
        <div class="setting-info">
          <label for="aiToolApproval">JavaScript Execution</label>
          <p class="setting-description">How to handle AI requests to run JavaScript on pages</p>
        </div>
        <select id="aiToolApproval" class="input-select">
          <option value="manual">Require manual approval</option>
          <option value="auto">Run automatically</option>
        </select>
      </div>

      <div class="ai-suggestions-section">
        <h3 class="subsection-title">Quick Suggestions</h3>
        <p class="section-description">Customise the quick suggestion buttons shown in the AI panel. These help you quickly ask common questions.</p>

        <div id="aiSuggestionsContainer" class="ai-suggestions-container">
          <!-- Suggestions will be populated dynamically -->
        </div>

        <div class="button-group">
          <button id="addSuggestion" class="btn btn-secondary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
            </svg>
            Add Suggestion
          </button>
          <button id="resetSuggestions" class="btn btn-secondary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
            </svg>
            Reset to Defaults
          </button>
        </div>
      </div>
    </section>

    <!-- Reset -->
    <section class="card card-danger">
      <h2>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
        </svg>
        Reset
      </h2>

      <p class="section-description">Reset all settings to their default values. This cannot be undone.</p>

      <div class="button-group">
        <button id="resetAll" class="btn btn-danger">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
          </svg>
          Reset All Settings
        </button>
      </div>
    </section>

    <!-- Status bar -->
    <div id="statusBar" class="status-bar">
      <span id="statusMessage"></span>
    </div>

    <!-- Version -->
    <footer class="footer">
      <p>Locate v<span id="version">1.0.0</span></p>
      <p class="footer-links">
        <a href="https://github.com" target="_blank">GitHub</a>
        <span>â€¢</span>
        <a href="#" id="reportIssue">Report Issue</a>
      </p>
    </footer>
  </div>

  <!-- Keybind capture modal -->
  <div id="keybindModal" class="modal" hidden>
    <div class="modal-content">
      <h3>Press new shortcut</h3>
      <p id="keybindModalAction"></p>
      <div id="keybindModalCapture" class="keybind-capture">Press any key combination...</div>
      <p id="keybindModalConflict" class="keybind-conflict" hidden></p>
      <div class="modal-buttons">
        <button id="keybindModalCancel" class="btn btn-secondary">Cancel</button>
        <button id="keybindModalSave" class="btn btn-primary" disabled>Save</button>
      </div>
    </div>
  </div>

  <script src="../shared/storage.js"></script>
  <script src="../shared/ai-providers.js"></script>
  <script src="options.js"></script>
</body>
</html>
